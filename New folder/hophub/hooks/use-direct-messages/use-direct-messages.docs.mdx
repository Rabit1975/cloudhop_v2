---
description: A React hook for managing HopHub direct message conversations
labels: ['hook', 'react', 'direct-messages', 'graphql']
---

A React hook for managing HopHub direct message conversations. This hook exposes functionality to list all direct message conversations, fetch a single conversation by ID, and create new conversations. It also provides loading and error states for each operation.

### Fetching All Direct Messages

This example shows how to use the useListDirectMessages hook to retrieve all direct message conversations for the current user. It also demonstrates handling loading and error states.

```tsx
import { useListDirectMessages } from './use-list-direct-messages.js';
import React from 'react';

// For example:
// type DirectMessage = {
//   id: string;
//   participantIds: string[];
//   createdAt: string;
//   updatedAt: string;
// };
const ListDirectMessagesComponent = () => {
  const mockDirectMessages = [
    {
      id: 'dm1',
      participantIds: ['user1', 'user2'],
      createdAt: '2023-01-01T10:00:00Z',
      updatedAt: '2023-01-01T10:05:00Z',
    },
    {
      id: 'dm2',
      participantIds: ['user1', 'user3'],
      createdAt: '2023-01-02T11:00:00Z',
      updatedAt: '2023-01-02T11:10:00Z',
    },
  ];
  const { directMessages, loading, error } = useListDirectMessages({
    mockData: mockDirectMessages,
  });
  if (loading) return <p>Loading direct messages...</p>;
  if (error) return <p>Error fetching direct messages: {error.message}</p>;
  return (
    <div>
      <h2>Your Direct Messages</h2>
      {directMessages.length === 0 ? (
        <p>No direct messages found.</p>
      ) : (
        <ul>
          {directMessages.map((dm) => (
            <li key={dm.id}>
              Conversation ID: {dm.id}, Participants: {dm.participantIds.join(', ')}
            </li>
          ))}
        </ul>
      )}
    </div>
  );
};
```

### Displaying a Specific Direct Message

This example illustrates how to fetch and display a single direct message conversation by its ID using the useDirectMessage hook. It includes handling cases where the conversation is loading or an error occurs.

```tsx
import { useDirectMessage } from './use-direct-message.js';
import React from 'react';

const SingleDirectMessageComponent = () => {
  const conversationId = 'dm1'; // Replace with a dynamic ID in a real application
  const mockDirectMessage = {
    id: 'dm1',
    participantIds: ['user1', 'user2'],
    createdAt: '2023-01-01T10:00:00Z',
    updatedAt: '2023-01-01T10:05:00Z',
  };
  const { directMessage, loading, error } = useDirectMessage(conversationId, {
    mockData: mockDirectMessage,
  });
  if (loading) return <p>Loading direct message...</p>;
  if (error) return <p>Error fetching direct message: {error.message}</p>;
  if (!directMessage) return <p>Direct message not found.</p>;
  return (
    <div>
      <h2>Direct Message Details</h2>
      <p>ID: {directMessage.id}</p>
      <p>Participants: {directMessage.participantIds.join(', ')}</p>
      <p>Created At: {new Date(directMessage.createdAt).toLocaleString()}</p>
      <p>Updated At: {new Date(directMessage.updatedAt).toLocaleString()}</p>
    </div>
  );
};
```

### Creating a New Direct Message Conversation

This example demonstrates how to use the useCreateDirectMessage hook to start a new direct message conversation between users. It shows how to pass participant IDs and manage the mutation process.

```tsx
import { useCreateDirectMessage } from './use-create-direct-message.js';
import React, { useState } from 'react';

const CreateDirectMessageComponent = () => {
  const { createDirectMessage, loading, error, data } = useCreateDirectMessage();
  const [targetUserId, setTargetUserId] = useState('');
  const [createdDmId, setCreatedDmId] = useState('');
  const handleCreateDM = async () => {
    try {
      const newDm = await createDirectMessage(['currentUserId', targetUserId]);
      if (newDm) {
        setCreatedDmId(newDm.id);
        alert(`Direct message created with ID: ${newDm.id}`);
      }
    } catch (err) {
      // Error handling is managed by the hook
    }
  };
  return (
    <div>
      <h2>Create New Direct Message</h2>
      <input
        type="text"
        placeholder="Enter target user ID"
        value={targetUserId}
        onChange={(e) => setTargetUserId(e.target.value)}
      />
      <button onClick={handleCreateDM} disabled={loading || !targetUserId}>
        {loading ? 'Creating...' : 'Create DM'}
      </button>
      {error && <p style={{ color: 'red' }}>Error creating DM: {error.message}</p>}
      {createdDmId && (
        <p style={{ color: 'green' }}>Successfully created DM with ID: {createdDmId}</p>
      )}
    </div>
  );
};