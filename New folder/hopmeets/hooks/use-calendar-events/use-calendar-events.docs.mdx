---
description: A React Hook for managing calendar event data and external calendar integrations.
labels: ['react', 'hook', 'calendar', 'events', 'graphql', 'integration']
---

A React Hook for managing calendar event data and external calendar integrations. It provides individual hooks for fetching, listing, creating, updating, and deleting events, as well as managing connections to external calendar services.

## Usage

### Displaying Calendar Events

This example demonstrates how to list calendar events and view details of a selected event. The `useListCalendarEvents` hook fetches a list of events, and `useGetCalendarEvent` fetches a single event by ID.

```tsx
import { useState } from 'react';
// Example mock data for events in documentation
const mockEvents = [
  {
    id: 'event1',
    title: 'Team Meeting',
    description: 'Weekly team sync up',
    startTime: '2024-07-20T10:00:00Z',
    endTime: '2024-07-20T11:00:00Z',
    attendees: ['user1', 'user2'],
    location: 'Zoom Link',
    meetingId: 'event1',
  },
  {
    id: 'event2',
    title: 'Project Review',
    description: 'Review Q3 project progress',
    startTime: '2024-07-21T14:00:00Z',
    endTime: '2021-07-21T15:30:00Z',
    attendees: ['user3', 'user4'],
    location: 'Meeting Room A',
    meetingId: 'event2',
  },
];
const EventDisplayComponent = () => {
  const [selectedEventId, setSelectedEventId] = useState<string | undefined>(undefined);
  const { events, loading: listLoading, error: listError } = useListCalendarEvents({
    mockData: mockEvents, // Using mock data for documentation example
  });
  const { event: selectedEvent, loading: singleLoading, error: singleError } = useGetCalendarEvent({
    meetingId: selectedEventId || '',
    mockData: selectedEventId ? mockEvents.find(e => e.id === selectedEventId) : undefined, // Simulate fetching from mock
  });
  if (listLoading) return <p>Loading events...</p>;
  if (listError) return <p>Error loading events: {listError.message}</p>;
  return (
    <div>
      <h2>Upcoming Events</h2>
      {events.length === 0 ? (
        <p>No events found.</p>
      ) : (
        <ul>
          {events.map((event) => (
            <li key={event.id} onClick={() => setSelectedEventId(event.id)} style={{ cursor: 'pointer' }}>
              {event.title} - {new Date(event.startTime).toLocaleDateString()}
            </li>
          ))}
        </ul>
      )}

      {selectedEventId && (
        <div>
          <h3>Selected Event Details</h3>
          {singleLoading && <p>Loading event details...</p>}
          {singleError && <p>Error loading event details: {singleError.message}</p>}
          {selectedEvent && (
            <div>
              <p>Title: {selectedEvent.title}</p>
              <p>Description: {selectedEvent.description}</p>
              <p>Start: {new Date(selectedEvent.startTime).toLocaleString()}</p>
              <p>End: {new Date(selectedEvent.endTime).toLocaleString()}</p>
              <p>Location: {selectedEvent.location}</p>
              <button onClick={() => setSelectedEventId(undefined)}>Clear Selection</button>
            </div>
          )}
        </div>
      )}
    </div>
  );
};
```

### Managing Calendar Events

This example illustrates how to create, update, and delete calendar events. It uses `useCreateCalendarEvent`, `useUpdateCalendarEvent`, and `useDeleteCalendarEvent` to perform these operations.

```tsx
import { useState } from 'react';
const EventManagementComponent = () => {
  const [newEventTopic, setNewEventTopic] = useState('');
  const [updateEventId, setUpdateEventId] = useState('');
  const [updatedEventTopic, setUpdatedEventTopic] = useState('');
  const [deleteEventId, setDeleteEventId] = useState('');
  const [message, setMessage] = useState('');

  const { createEvent, loading: createLoading, error: createError } = useCreateCalendarEvent();
  const { updateEvent, loading: updateLoading, error: updateError } = useUpdateCalendarEvent();
  const { deleteEvent, loading: deleteLoading, error: deleteError } = useDeleteCalendarEvent();

  const handleCreateEvent = async () => {
    try {
      const event = await createEvent({
        topic: newEventTopic,
        startTime: new Date().toISOString(),
        endTime: new Date(Date.now() + 3600000).toISOString(), // 1 hour from now
        description: 'New event created from example',
      });
      setMessage(`Event created: ${event.title} (ID: ${event.id})`);
      setNewEventTopic('');
    } catch (err) {
      setMessage(`Error creating event: ${createError?.message || 'Unknown error'}`);
    }
  };

  const handleUpdateEvent = async () => {
    try {
      const event = await updateEvent({
        meetingId: updateEventId,
        topic: updatedEventTopic,
      });
      setMessage(`Event updated: ${event.title} (ID: ${event.id})`);
      setUpdateEventId('');
      setUpdatedEventTopic('');
    } catch (err) {
      setMessage(`Error updating event: ${updateError?.message || 'Unknown error'}`);
    }
  };

  const handleDeleteEvent = async () => {
    try {
      const success = await deleteEvent(deleteEventId);
      if (success) {
        setMessage(`Event ${deleteEventId} deleted successfully.`);
        setDeleteEventId('');
      } else {
        setMessage(`Failed to delete event ${deleteEventId}.`);
      }
    } catch (err) {
      setMessage(`Error deleting event: ${deleteError?.message || 'Unknown error'}`);
    }
  };

  return (
    <div>
      <h2>Manage Events</h2>
      {message && <p>{message}</p>}

      <h3>Create Event</h3>
      <input
        type="text"
        value={newEventTopic}
        onChange={(e) => setNewEventTopic(e.target.value)}
        placeholder="New event topic"
      />
      <button onClick={handleCreateEvent} disabled={createLoading}>
        {createLoading ? 'Creating...' : 'Create Event'}
      </button>

      <h3>Update Event</h3>
      <input
        type="text"
        value={updateEventId}
        onChange={(e) => setUpdateEventId(e.target.value)}
        placeholder="Event ID to update"
      />
      <input
        type="text"
        value={updatedEventTopic}
        onChange={(e) => setUpdatedEventTopic(e.target.value)}
        placeholder="New topic"
      />
      <button onClick={handleUpdateEvent} disabled={updateLoading}>
        {updateLoading ? 'Updating...' : 'Update Event'}
      </button>

      <h3>Delete Event</h3>
      <input
        type="text"
        value={deleteEventId}
        onChange={(e) => setDeleteEventId(e.target.value)}
        placeholder="Event ID to delete"
      />
      <button onClick={handleDeleteEvent} disabled={deleteLoading}>
        {deleteLoading ? 'Deleting...' : 'Delete Event'}
      </button>
    </div>
  );
};
```

### Managing Calendar Integrations

This example shows how to list, add, and remove external calendar service integrations. It uses `useCalendarIntegrations`, `useAddCalendarIntegration`, and `useRemoveCalendarIntegration`.

```tsx
import { useState } from 'react';
const IntegrationManagementComponent = () => {
  const [newProvider, setNewProvider] = useState('');
  const [newAuthCode, setNewAuthCode] = useState('');
  const [newRedirectUri, setNewRedirectUri] = useState('http://localhost:3000/callback');
  const [integrationToRemove, setIntegrationToRemove] = useState('');
  const [message, setMessage] = useState('');

  // Example mock data for integrations in documentation
  const mockIntegrations = [
    {
      id: 'int1',
      userId: 'user1',
      provider: 'google',
      email: 'user1@gmail.com',
      connectedAt: new Date().toISOString(),
    },
  ];

  const {
    integrations,
    loading: listLoading,
    error: listError,
    refetch,
  } = useCalendarIntegrations({ mockData: mockIntegrations }); // Using mock data for documentation example

  const {
    addIntegration,
    loading: addLoading,
    error: addError,
  } = useAddCalendarIntegration();

  const {
    removeIntegration,
    loading: removeLoading,
    error: removeError,
  } = useRemoveCalendarIntegration();

  const handleAddIntegration = async () => {
    try {
      const integration = await addIntegration({
        provider: newProvider,
        authCode: newAuthCode,
        redirectUri: newRedirectUri,
      });
      setMessage(`Integration added for ${integration.provider} (${integration.email})`);
      setNewProvider('');
      setNewAuthCode('');
      // In a real application, you might refetch the integrations here
      // refetch();
    } catch (err) {
      setMessage(`Error adding integration: ${addError?.message || 'Unknown error'}`);
    }
  };

  const handleRemoveIntegration = async () => {
    try {
      const success = await removeIntegration(integrationToRemove);
      if (success) {
        setMessage(`Integration ${integrationToRemove} removed.`);
        setIntegrationToRemove('');
        // In a real application, you might refetch the integrations here
        // refetch();
      } else {
        setMessage(`Failed to remove integration ${integrationToRemove}.`);
      }
    } catch (err) {
      setMessage(`Error removing integration: ${removeError?.message || 'Unknown error'}`);
    }
  };

  return (
    <div>
      <h2>Calendar Integrations</h2>
      {message && <p>{message}</p>}

      <h3>Connected Integrations</h3>
      {listLoading && <p>Loading integrations...</p>}
      {listError && <p>Error loading integrations: {listError.message}</p>}
      {integrations.length === 0 ? (
        <p>No integrations connected.</p>
      ) : (
        <ul>
          {integrations.map((integration) => (
            <li key={integration.id}>
              {integration.provider} - {integration.email} (ID: {integration.id})
            </li>
          ))}
        </ul>
      )}

      <h3>Add New Integration</h3>
      <input
        type="text"
        value={newProvider}
        onChange={(e) => setNewProvider(e.target.value)}
        placeholder="Provider (e.g., google)"
      />
      <input
        type="text"
        value={newAuthCode}
        onChange={(e) => setNewAuthCode(e.target.value)}
        placeholder="Auth Code"
      />
      <input
        type="text"
        value={newRedirectUri}
        onChange={(e) => setNewRedirectUri(e.target.value)}
        placeholder="Redirect URI"
      />
      <button onClick={handleAddIntegration} disabled={addLoading}>
        {addLoading ? 'Adding...' : 'Add Integration'}
      </button>

      <h3>Remove Integration</h3>
      <input
        type="text"
        value={integrationToRemove}
        onChange={(e) => setIntegrationToRemove(e.target.value)}
        placeholder="Integration ID to remove"
      />
      <button onClick={handleRemoveIntegration} disabled={removeLoading}>
        {removeLoading ? 'Removing...' : 'Remove Integration'}
      </button>
    </div>
  );
};